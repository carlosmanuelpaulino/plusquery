/*!
 * plusQuery JavaScript Library 
 * http://github.com/tyscorp/plusquery/
 *
 * Copyright (C) 2011 by Tyson Cleary
 * 
 * Licensed under the MIT license.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 * Contains code and concepts from the jQuery JavaScript Library.
 * http://jquery.com/
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Date: Tue Mar 8 22:24:02 2011 +1100
 */
function OnGetScriptCommands(){var a=$A(arguments);a.push([]);return plusQuery.trigger(plusQuery,"OnGetScriptCommands",a)}function OnGetScriptMenu(){var a=$A(arguments);a.push({});return plusQuery.trigger(plusQuery,"OnGetScriptMenu",a)}function OnEvent_UploadFileComplete(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"UploadFileComplete",a)}function OnEvent_DownloadFileComplete(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"DownloadFileComplete",a)}function OnEvent_LeavePersonalizedStatus(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"LeavePersonalizedStatus",a)}function OnEvent_EnterPersonalizedStatus(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"EnterPersonalizedStatus",a)}function OnEvent_MenuClicked(){var a=$A(arguments);return plusQuery.trigger(plusQuery(a[2]),"MenuClicked",a)}function OnEvent_Timer(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"Timer",a)}function OnEvent_MessengerUnlocked(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"MessengerUnlocked",a)}function OnEvent_MessengerLocked(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"MessengerLocked",a)}function OnEvent_Uninitialize(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"Uninitialize",a)}function OnEvent_Initialize(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"Initialize",a)}function OnEvent_ChatWndSendMessage(){var a=$A(arguments);return plusQuery.trigger(plusQuery(a[0]),"ChatWndSendMessage",a)}function OnEvent_ChatWndReceiveMessage(){var a=$A(arguments);return plusQuery.trigger(plusQuery(a[0]),"ChatWndReceiveMessage",a)}function OnEvent_ChatWndContactRemoved(){var a=$A(arguments);return plusQuery.trigger(plusQuery(a[0]),"ChatWndContactRemoved",a)}function OnEvent_ChatWndContactAdded(){var a=$A(arguments);return plusQuery.trigger(plusQuery(a[0]),"ChatWndContactAdded",a)}function OnEvent_ChatWndDestroyed(){var a=$A(arguments);return plusQuery.trigger(plusQuery(a[0]),"ChatWndDestroyed",a)}function OnEvent_ChatWndCreated(){var a=$A(arguments);return plusQuery.trigger(plusQuery(a[0]),"ChatWndCreated",a)}function OnEvent_ContactListWndDestroyed(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"ContactListWndDestroyed",a)}function OnEvent_ContactListWndCreated(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"ContactListWndCreated",a)}function OnEvent_ContactUnblocked(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactUnblocked",a)}function OnEvent_ContactBlocked(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactBlocked",a)}function OnEvent_ContactMediaChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactMediaChange")}function OnEvent_ContactPsmChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactPsmChange",a)}function OnEvent_ContactNameChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactNameChange")}function OnEvent_ContactStatusChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactStatusChange")}function OnEvent_ContactSignout(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactSignout",a)}function OnEvent_ContactSignin(){var a=$A(arguments);return plusQuery.trigger(plusQuery(Messenger.MyContacts.GetContact(a[0])),"ContactSignin",a)}function OnEvent_MyMediaChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery.MyContact(),"MyMediaChange",a)}function OnEvent_MyPsmChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery.MyContact(),"MyPsmChange",a)}function OnEvent_MyNameChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery.MyContact(),"MyNameChange",a)}function OnEvent_MyStatusChange(){var a=$A(arguments);return plusQuery.trigger(plusQuery.MyContact(),"MyStatusChange",a)}function OnEvent_Signout(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"Signout",a)}function OnEvent_SigninReady(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"SigninReady",a)}function OnEvent_Signin(){var a=$A(arguments);return plusQuery.trigger(plusQuery,"Signin",a)}(function(){function a(a){if(!a)return[];if(a.toArray)return a.toArray();var b=a.length||0,c=Array(b);while(b--)c[b]=a[b];return c}(function(){var a=function(b){return new a.fn.init(b)};a.interfaces={},a.interfaces.extend({Debug:function(a){this.proxy=a,this.type="Debug",this.DebuggingWindowVisible=this.proxy.DebuggingWindowVisible,this.init.call(this,this.proxy);return this},Messenger:function(a){this.proxy=a,this.type="Messenger",this.Version=this.proxy.Version,this.VersionBuild=this.proxy.VersionBuild,this.ContactListWndHandle=this.proxy.ContactListWndHandle,this.CurrentChats=this.proxy.CurrentChats,this.ReceiveFileDir=this.proxy.ReceiveFileDir,this.MyContacts=this.proxy.MyContacts,this.MyEmail=this.proxy.MyEmail,this.MyUserId=this.proxy.MyUserId,this.MyStatus=this.proxy.MyStatus,this.MyName=this.proxy.MyName,this.MyPersonalMessage=this.proxy.MyPersonalMessage,this.MyCurrentMedia=this.proxy.MyCurrentMedia,this.MyDisplayPicture=this.proxy.MyDisplayPicture,this.CustomEmoticons=this.proxy.CustomEmoticons,this.init.call(this,this.proxy);return this},MsgPlus:function(a){this.proxy=a,this.type="MsgPlus",this.init.call(this,this.proxy);return this},ChatWnds:function(a){this.proxy=a,this.type="ChatWnds",this.Count=this.proxy.Count,this.init.call(this,this.proxy);return this},ChatWnd:function(a){this.proxy=a,this.type="ChatWnd",this.Handle=this.proxy.Handle,this.Contacts=this.proxy.Contacts,this.EditText=this.proxy.EditText,this.EditChangeAllowed=this.proxy.EditChangeAllowed,this.ChatLogEnabled=this.proxy.ChatLogEnabled,this.OverrideFmtEnabled=this.proxy.OverrideFmtEnabled,this.IsMobileChat=this.proxy.IsMobileChat,this.init.call(this,this.proxy);return this},Contacts:function(a){this.proxy=a,this.type="Contacts",this.Count=this.proxy.Count,this.init.call(this,this.proxy);return this},Contact:function(a){this.proxy=a,this.type="Contact",this.Email=this.proxy.Email,this.Network=this.proxy.Network,this.Status=this.proxy.Status,this.Name=this.proxy.Name,this.PersonalMessage=this.proxy.PersonalMessage,this.CurrentMedia=this.proxy.CurrentMedia,this.Blocked=this.proxy.Blocked,this.DisplayPicture=this.proxy.DisplayPicture,this.IsFloating=this.proxy.IsFloating,this.ProfileColor=this.proxy.ProfileColor,this.init.call(this,this.proxy);return this},Emoticons:function(a){this.proxy=a,this.type="Emoticons",this.Count=this.proxy.Count,this.init.call(this,this.proxy);return this},Emoticon:function(a){this.proxy=a,this.type="Emoticon",this.Shortcut=this.proxy.Shortcut,this.Name=this.proxy.Name,this.PictureFile=this.proxy.PictureFile,this.init.call(this,this.proxy);return this},PlusWnd:function(a){this.proxy=a,this.type="PlusWnd",this.Handle=this.proxy.Handle,this.Visible=this.proxy.Visible,this.WindowId=this.proxy.WindowId,this.BaseColor=this.proxy.BaseColor,this.init.call(this,this.proxy);return this},Interop:function(a){this.proxy=a,this.type="Interop",this.init.call(this,this.proxy);return this},DataBloc:function(a){this.proxy=a,this.type="DataBloc",this.Size=this.proxy.Size,this.DataPtr=this.proxy.DataPtr,this.init.call(this,this.proxy);return this}}),a.interfaces.Debug.prototype={init:function(a){},Trace:function(a){return this.proxy.Trace(a)},ClearDebuggingWindow:function(){return this.proxy.ClearDebuggingWindow()}},a.interfaces.Messenger.prototype={init:function(a){},AutoSignin:function(){return this.proxy.AutoSignin()},Signout:function(){return this.proxy.Signout()},OpenChat:function(a){return this.proxy.OpenChat(a)}},a.interfaces.MsgPlus.prototype={init:function(a){},DisplayToast:function(a,b,c,d,e){return this.proxy.DisplayToast(a,b,c,d,e)},DisplayToastContact:function(a,b,c,d,e,f,g){return this.proxy.DisplayToastContact(a,b,c,d,e,f,g)},CreateWnd:function(a,b,c){return this.proxy.CreateWnd(a,b,c)},CreateChildWnd:function(a,b,c,d,e,f){return this.proxy.CreateChildWnd(a,b,c,d,e,f)},AddTimer:function(a,b){return this.proxy.AddTimer(a,b)},CancelTimer:function(a){return this.proxy.CancelTimer(a)},PlaySound:function(a,b){return this.proxy.PlaySound(a,b)},LockMessenger:function(a){return this.proxy.LockMessenger(a)},LogEvent:function(a,b,c){return this.proxy.LogEvent(a,b,c)},RemoveFormatCodes:function(a){return this.proxy.RemoveFormatCodes(a)},DownloadFile:function(a,b,c,d){return this.proxy.DownloadFile(a,b,c,d)},UploadFileFTP:function(a,b,c,d,e,f,g){return this.proxy.UploadFileFTP(a,b,c,d,e,f,g)},LoadScriptFile:function(a){return this.proxy.LoadScriptFile(a)},ExtractFromZIP:function(a,b,c,d){return this.proxy.ExtractFromZIP(a,b,c,d)}},a.interfaces.ChatWnds.prototype={init:function(a){},Iterator:function(){return this.proxy.Iterator()}},a.interfaces.ChatWnd.prototype={init:function(a){},SendMessage:function(a){return this.proxy.SendMessage(a)},SendFile:function(a){return this.proxy.SendFile(a)},AddContact:function(a){return this.proxy.AddContact(a)},DisplayInfoMessage:function(a,b,c){return this.proxy.DisplayInfoMessage(a,b,c)},ResetInfoMessage:function(){return this.proxy.ResetInfoMessage()},EditText_SetCurSelStart:function(){return this.proxy.EditText_SetCurSelStart()},EditText_SetCurSelEnd:function(){return this.proxy.EditText_SetCurSelEnd()},EditText_SetCurSel:function(a,b){return this.proxy.EditText_SetCurSel(a,b)},EditText_ReplaceSel:function(a){return this.proxy.EditText_ReplaceSel(a)},HistoryText_GetCurSelStart:function(){return this.proxy.HistoryText_GetCurSelStart()},HistoryText_GetCurSelEnd:function(){return this.proxy.HistoryText_GetCurSelEnd()},HistoryText_GetTextRange:function(a,b,c){return this.proxy.HistoryText_GetTextRange(a,b,c)}},a.interfaces.Contacts.prototype={init:function(a){},Iterator:function(){return this.proxy.Iterator()},GetContact:function(a){return this.proxy.GetContact(a)}},a.interfaces.Contact.prototype={init:function(a){}},a.interfaces.Emoticons.prototype={init:function(a){},Iterator:function(){return this.proxy.Iterator()},GetEmoticon:function(a){return original.GetEmoticon(a)}},a.interfaces.Emoticon.prototype={init:function(a){}},a.interfaces.PlusWnd.prototype={init:function(a){}},a.interfaces.Interop.prototype={init:function(a){},Call:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return this.proxy.Call(a,b,c,d,e,f,g,h,i,j,k,l,m,n)},Call2:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return this.proxy.Call2(a,b,c,d,e,f,g,h,i,j,k,l,m,n)},FreeDll:function(a){return this.proxy.FreeDll(a)},GetLastError:function(){return this.proxy.GetLastError()},Allocate:function(a){return this.proxy.Allocate(a)},GetCallbackPtr:function(a){return this.proxy.GetCallbackPtr(a)}},a.interfaces.DataBloc.prototype={init:function(a){},GetAt:function(a){return this.proxy.GetAt(a)},SetAt:function(a,b){return this.proxy.SetAt(a,b)},ReadString:function(){return this.proxy.ReadString()},WriteString:function(a,b,c){return this.proxy.WriteString(a,b,c)},ReadBSTR:function(){return this.proxy.ReadBSTR()},WriteBSTR:function(){return this.proxy.WriteBSTR()},ReadWORD:function(){return this.proxy.ReadWORD()},WriteWORD:function(){return this.proxy.WriteWORD()},ReadDWORD:function(){return this.proxy.ReadDWORD()},WriteDWORD:function(){return this.proxy.WriteDWORD()},ReadInterfacePtr:function(){return this.proxy.ReadInterfacePtr()},WriteInterfacePtr:function(){return this.proxy.WriteInterfacePtr()}},a.fn=a.prototype={constructor:a,init:function(b){if(!b||b instanceof a)return this;if(typeof b.Trace==="unknown")return this.extend(new a.interfaces.Debug(b));if(typeof b.AutoSignin==="unknown")return this.extend(new a.interfaces.Messenger(b));if(typeof b.LockMessenger==="unknown")return this.extend(new a.interfaces.MsgPlus(b));if(typeof b.GetContact==="unknown")return this.extend(new a.interfaces.Contacts(b));if(typeof b.GetEmoticons==="unknown")return this.extend(new a.interfaces.Emoticons(b));if(b.Count)return this.extend(new a.interfaces.ChatWnds(b));if(typeof b.SendMessage==="unknown")return this.extend(new a.interfaces.ChatWnd(b));if(typeof b.Email!=="undefined"&&typeof b.Network!=="undefined"&&typeof b.Status!=="undefined"&&typeof b.Name!=="undefined"&&typeof b.PersonalMessage!=="undefined"&&typeof b.CurrentMedia!=="undefined"&&typeof b.DisplayPicture!=="undefined")return this.extend(new a.interfaces.Contact(b));if(typeof b.Shortcut!=="undefined"&&typeof b.Name!=="undefined"&&typeof b.PictureFile!=="undefined")return this.extend(new a.interfaces.Emoticon(b));if(typeof b.Close==="unknown")return this.extend(new a.interfaces.PlusWnd(b));if(typeof b.Call==="unknown")return this.extend(new a.interfaces.Interop(b));if(typeof b.SetAt==="unknown")return this.extend(new a.interfaces.DataBloc(b));return this},length:0,size:function(){return this.length},toArray:function(){return Array.prototype.slice.call(this,0)},type:"PlusQuery",toString:function(){return"[object "+this.type+"]"}},a.fn.init.prototype=a.fn,a.extend({noop:function(){},guid:1,now:function(){return(new Date).getTime()},MyContact:function(){return $({Email:Messenger.MyEmail,Network:1,Status:Messenger.MyStatus,Name:Messenger.MyName,PersonalMessage:Messenger.MyPersonalMessage,CurrentMedia:Messenger.MyCurrentMedia,Blocked:!1,DisplayPicture:Messenger.MyDisplayPicture,IsFloating:!1,ProfileColor:0})}});return a})(),function(a){a.interfaces.Debug.prototype.extend({Enabled:!0,Trace:function(a){this.Enabled&&this.proxy.Trace(String(a))}}),a.interfaces.Messenger=function(b){this.proxy=b,this.typeOf="Messenger",this.Version=this.proxy.Version,this.VersionBuild=this.proxy.VersionBuild,this.ContactListWndHandle=this.proxy.ContactListWndHandle,this.ReceiveFileDir=this.proxy.ReceiveFileDir,this.MyEmail=this.proxy.MyEmail,this.MyUserId=this.proxy.MyUserId,this.MyStatus=this.proxy.MyStatus,this.MyName=this.proxy.MyName,this.MyPersonalMessage=this.proxy.MyPersonalMessage,this.MyCurrentMedia=this.proxy.MyCurrentMedia,this.MyDisplayPicture=this.proxy.MyDisplayPicture,this.CurrentChats=a(this.proxy.CurrentChats),this.MyContacts=a(this.proxy.MyContacts),this.CustomEmoticons=a(this.proxy.CustomEmoticons);return this},a.interfaces.MsgPlus.prototype.extend({DisplayToast:function(a,b,c,d,e){if(d.isFunction())return this.proxy.DisplayToast(a,b,c||"","DisplayToastCallback",[d,e]);return this.proxy.DisplayToast(a,b,c,d,e)},DisplayToastContact:function(a,b,c,d,e,f,g){if(e.isFunction())return this.proxy.DisplayToastContact(a,b,c,d||"","DisplayToastCallback",[e,f],g);return this.proxy.DisplayToastContact(a,b,c,d,e,f,g)}}),a.interfaces.ChatWnds=function(b){this.proxy=b,this.typeOf="ChatWnds";for(var c=new Enumerator(this.proxy),d=0;!c.atEnd();c.moveNext(),d++)this[d]=a(c.item());this.length=d},a.interfaces.ChatWnd.prototype.extend({trigger:function(a,b){if(a.object&&a.object.Handle&&a.object.Handle===this.Handle)return a.callback.apply(this,b)}}),a.interfaces.Contacts=function(b){this.proxy=b,this.typeOf="Contacts",this[0]=a.MyContact();for(var c=new Enumerator(this.proxy),d=1;!c.atEnd();c.moveNext(),d++)this[d]=a(c.item());this.length=d+1},a.interfaces.Contacts.prototype.extend({GetContact:function(b){if(b.toLowerCase()===Messenger.MyEmail.toLowerCase())return this[0];if(this.proxy.GetContact(b))return a(this.proxy.GetContact(b));for(var c=0;c<this.length;c++)if(this[c].Name===b)return this[c];return null}}),DisplayToastCallback=function(){arguments[0][0].call(this,arguments[0][1])}}(plusQuery),function(a){var b=function(b,c,d){this.object=b,this.eventName=c,this.callback=d,this.guid=a.guid++};b.CACHE={},b.RETURNS={ChatWndReceiveMessage:3,ChatWndSendMessage:2,OnGetScriptMenu:1,OnGetScriptCommands:0},b.prototype.extend({start:function(){a.addEventListener(this.object,this.eventName,this.callback);return this},stop:function(){a.removeEventListener(this.object,this.eventName,this.callback);return this},trigger:function(a){return this.callback.apply(this,a)}}),a.extend({Event:b,addEventListener:function(){var c,d,e;arguments[0].isString()?(c=a,d=arguments[0],e=arguments[1]):(c=arguments[0],d=arguments[1],e=arguments[2]),d=d.split(" ");for(var f=0;f<d.length;f++){var g=new b(c,d[f],e);b.CACHE[g.guid]=g}return this},removeEventListener:function(a,c,d){b.CACHE.forEach(function(e){e.object===a&&e.eventName===c&&e.callback===d&&delete b.CACHE[e.guid]});return this},bind:function(a,c,d){return(new b(a,c,d)).start()},trigger:function(c,d,e){var f;b.CACHE.forEach(function(g){if(g.eventName===d)try{g.object===a?(f=g.trigger(e),f!==undefined&&(e[b.RETURNS[d]]=f)):(f=c.trigger(g,e),f!==undefined&&(e[b.RETURNS[d]]=f))}catch(h){a(Debug).Trace(h.name+": "+h.message+" ("+h.number+")\n\tEvent: "+d)}});return e[b.RETURNS[d]]}}),a.prototype.extend({addEventListener:function(b,c){return a.addEventListener(this,b,c)},removeEventListener:function(b,c){return a.removeEventListener(this,b,c)},bind:function(b,c){return a.bind(this,b,c)},trigger:a.noop})}(plusQuery),function(a){var b=function(a,c,d){this.callback=a,this.delay=c,this.repeat=d,this.id="TYSCRIPT#"+TYSCRIPT.guid++,b.CACHE[this.id]=this};b.CACHE={},b.prototype.extend({start:function(){this.delay<300?this.trigger():MsgPlus.AddTimer(this.id,this.delay);return this},cancel:function(){MsgPlus.CancelTimer(this.id),delete b.CACHE[this.id];return this},trigger:function(){this.callback.apply(this),this.repeat&&this.start()}}),a.extend({setTimeout:function(a,c){return(new b(a,c,!1)).start()},setInterval:function(a,c){return(new b(a,c,!0)).start()},clearTimeout:function(a){a.id?b.CACHE[a.id].cancel():b.CACHE[a].cancel()},clearInterval:this.clearTimeout}),a.addEventListener("Timer",function(a){a.match(/TYSCRIPT#(\d+)/)&&b.CACHE[a].callback&&b.CACHE[this.id].trigger()})}(plusQuery),function(a){var b=function(b,c,d){this.commandName=b.toUpperCase(),this.command=c,this.callback=d,this.guid=a.guid++};b.CACHE={},a.extend({addCommand:function(){var a,c,d;arguments[1].isFunction()?(a=arguments[0],d=arguments[1]):(a=arguments[0],c=arguments[1],d=arguments[2]),a.split(" ").forEach(function(a){var e=new b(a,c,d);b.CACHE[e.guid]=e});return this},removeCommand:function(a){},triggerCommand:function(a,b,c,d){}})}(plusQuery)})();